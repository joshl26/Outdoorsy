<!-- views/partials/navbar.ejs -->
<head>
  <link rel="stylesheet" type="text/css" href="/outdoorsy/stylesheets/navbar.css" />
</head>

<header class="site-header" >
  <nav
    class="navbar navbar-expand-lg"
    aria-label="Main navigation"
    
  >
    <div class="container-fluid">
      <!-- Brand / Logo -->
      <a
        class="navbar-brand d-flex align-items-center"
        href="<%= basePath %>/"
        aria-label="Outdoorsy Home"
      >
        <svg
          class="brand-icon"
          width="32"
          height="32"
          viewBox="0 0 32 32"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
          focusable="false"
        >
          <path
            d="M16 4L4 12L16 20L28 12L16 4Z"
            fill="currentColor"
            opacity="0.7"
          />
          <path
            d="M4 20L16 28L28 20"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          />
        </svg>
        <span class="brand-text fw-semibold">Outdoorsy</span>
        <span class="brand-tagline d-none d-xl-inline ms-1 text-muted">
          Discover Nature
        </span>
      </a>

      <!-- Mobile Menu Toggle -->
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#mainNavigation"
        aria-controls="mainNavigation"
        aria-expanded="false"
        aria-label="Toggle navigation menu"
      >
        <span class="navbar-toggler-icon" aria-hidden="true"></span>
      </button>

      <!-- Navigation Content -->
      <div class="collapse navbar-collapse" id="mainNavigation">
        <!-- Primary Navigation -->
        <ul class="navbar-nav me-auto mb-2 mb-lg-0" role="menubar">
          <li class="nav-item" role="none">
            <a class="nav-link" href="<%= basePath %>/" role="menuitem">
              <svg
                class="nav-icon"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true"
              >
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                <polyline points="9 22 9 12 15 12 15 22" />
              </svg>
              <span class="nav-text">Home</span>
            </a>
          </li>

          <li class="nav-item" role="none">
            <a
              class="nav-link"
              href="<%= basePath %>/campgrounds"
              role="menuitem"
            >
              <svg
                class="nav-icon"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true"
              >
                <path
                  d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"
                ></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
              <span class="nav-text">Explore</span>
            </a>
          </li>

          <li class="nav-item" role="none">
            <a
              class="nav-link"
              href="<%= basePath %>/campgrounds/nearby"
              role="menuitem"
            >
              <svg
                class="nav-icon"
                aria-hidden="true"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"
                ></path>
                <circle cx="12" cy="10" r="3"></circle>
                <line x1="12" y1="2" x2="12" y2="6"></line>
              </svg>
              <span class="nav-text">Nearby</span>
            </a>
          </li>

          <% if (currentUser) { %>
            <li class="nav-item" role="none">
              <a
                class="nav-link"
                href="<%= basePath %>/campgrounds/new"
                role="menuitem"
              >
                <svg
                  class="nav-icon"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  aria-hidden="true"
                >
                  <circle cx="12" cy="12" r="10" />
                  <line x1="12" y1="8" x2="12" y2="16" />
                  <line x1="8" y1="12" x2="16" y2="12" />
                </svg>
                <span class="nav-text">Add Spot</span>
              </a>
            </li>
          <% } %>

          <!-- Discover Dropdown -->
          <li class="nav-item dropdown" role="none">
            <a
              class="nav-link dropdown-toggle"
              href="#"
              id="discoverMenu"
              data-bs-toggle="dropdown"
              aria-expanded="false"
              aria-haspopup="true"
              role="menuitem"
            >
              <svg
                class="nav-icon"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <polygon
                  points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"
                ></polygon>
              </svg>
              <span class="nav-text">Discover</span>
            </a>
            <ul
              class="dropdown-menu dropdown-menu-modern"
              aria-labelledby="discoverMenu"
              role="menu"
            >
              <li role="none">
                <a
                  class="dropdown-item"
                  href="<%= basePath %>/campgrounds?sort=rating"
                  role="menuitem"
                >
                  <svg
                    class="dropdown-icon"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    aria-hidden="true"
                  >
                    <polygon
                      points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                    ></polygon>
                  </svg>
                  <span>Top Rated</span>
                </a>
              </li>
              <li role="none">
                <a
                  class="dropdown-item"
                  href="<%= basePath %>/campgrounds?sort=recent"
                  role="menuitem"
                >
                  <svg
                    class="dropdown-icon"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    aria-hidden="true"
                  >
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                  <span>Recently Added</span>
                </a>
              </li>
              <li role="none"><hr class="dropdown-divider" /></li>
              <li role="none">
                <a
                  class="dropdown-item"
                  href="<%= basePath %>/api-docs"
                  role="menuitem"
                >
                  <svg
                    class="dropdown-icon"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                    aria-hidden="true"
                  >
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                  </svg>
                  <span>API Docs</span>
                </a>
              </li>
            </ul>
          </li>
        </ul>

       <!-- Search Bar -->
<form
  class="search-form d-flex align-items-center position-relative me-lg-3"
  role="search"
  action="<%= basePath %>/campgrounds"
  method="GET"
>
  <div class="input-group search-wrapper">
   
    <input
      class="form-control border-start-0 ps-3 search-input"
      type="search"
      placeholder="Search destinations..."
      aria-label="Search campgrounds"
      name="search"
    />
    <button
      type="submit"
      class="btn btn-primary px-3"
      aria-label="Submit search"
    >
      <i class="fas fa-search" aria-hidden="true"></i>
    </button>
  </div>
</form>

        <!-- User Actions -->
        <ul class="navbar-nav user-actions" role="menubar">
          <% if (!currentUser) { %>
            <li class="nav-item" role="none">
              <a class="nav-link" href="<%= basePath %>/login" role="menuitem">
                <svg
                  class="nav-icon"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  aria-hidden="true"
                >
                  <path
                    d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"
                  ></path>
                  <polyline points="10 17 15 12 10 7"></polyline>
                  <line x1="15" y1="12" x2="3" y2="12"></line>
                </svg>
                <span class="nav-text">Sign In</span>
              </a>
            </li>

            <li class="nav-item" role="none">
              <a
                class="btn btn-primary btn-signup"
                href="<%= basePath %>/register"
                role="menuitem"
              >
                <svg
                  class="btn-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  aria-hidden="true"
                >
                  <path
                    d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"
                  ></path>
                  <circle cx="8.5" cy="7" r="4"></circle>
                  <line x1="20" y1="8" x2="20" y2="14"></line>
                  <line x1="23" y1="11" x2="17" y2="11"></line>
                </svg>
                <span>Join Free</span>
              </a>
            </li>

          <% } else { %>
            <!-- User Dropdown -->
            <li class="nav-item dropdown user-dropdown" role="none">
              <a
                class="nav-link dropdown-toggle user-menu-toggle"
                href="#"
                id="userMenu"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                aria-haspopup="true"
                role="menuitem"
              >
                <div class="user-avatar">
                  <% if (currentUser.avatar) { %>
                    <img
                      src="<%= currentUser.avatar %>"
                      alt="<%= currentUser.username %> profile picture"
                      loading="lazy"
                    />
                  <% } else { %>
                    <svg
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                      stroke-width="2"
                      aria-hidden="true"
                    >
                      <path
                        d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"
                      ></path>
                      <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                  <% } %>
                </div>
                <span class="user-name d-none d-lg-inline"
                  ><%= currentUser.username %></span
                >
              </a>

              <ul
                class="dropdown-menu dropdown-menu-end dropdown-menu-modern user-menu"
                aria-labelledby="userMenu"
                role="menu"
              >
                <li class="dropdown-header" role="none">
                  <div class="user-info">
                    <strong class="d-block"><%= currentUser.username %></strong>
                    <small class="text-muted"
                      ><%= currentUser.email || 'Outdoor Enthusiast' %></small
                    >
                  </div>
                </li>
                <li role="none"><hr class="dropdown-divider" /></li>

                <li role="none">
                  <a
                    class="dropdown-item"
                    href="<%= basePath %>/profile"
                    role="menuitem"
                  >
                    <i class="fas fa-user me-2" aria-hidden="true"></i> My Profile
                  </a>
                </li>

                <li role="none">
                  <a
                    class="dropdown-item"
                    href="<%= basePath %>/campgrounds?user=<%= currentUser._id %>"
                    role="menuitem"
                  >
                    <i class="fas fa-tree me-2" aria-hidden="true"></i> My Campgrounds
                  </a>
                </li>

                <li role="none">
                  <a
                    class="dropdown-item"
                    href="<%= basePath %>/favorites"
                    role="menuitem"
                  >
                    <i class="fas fa-heart me-2" aria-hidden="true"></i> Favorites
                  </a>
                </li>

                <li role="none"><hr class="dropdown-divider" /></li>
                <li role="none">
                  <a
                    class="dropdown-item dropdown-item-logout"
                    href="<%= basePath %>/logout"
                    role="menuitem"
                  >
                    <i class="fas fa-sign-out-alt me-2" aria-hidden="true"></i>
                    Sign Out
                  </a>
                </li>
              </ul>
            </li>
          <% } %>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Scroll Progress -->
  <div
    class="scroll-progress"
    role="progressbar"
    aria-label="Page scroll progress"
  ></div>
</header>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const header = document.querySelector(".site-header");
    const navLinks = document.querySelectorAll(".navbar-nav .nav-link:not(.dropdown-toggle)");
    const dropdownItems = document.querySelectorAll(".dropdown-item");
    const navCollapse = document.querySelector(".navbar-collapse");
    const progressBar = document.querySelector(".scroll-progress");

    // Highlight active link
    const currentPath = window.location.pathname;
    navLinks.forEach((link) => {
      const href = link.getAttribute("href");
      if (currentPath === href || (href !== "/" && currentPath.startsWith(href))) {
        link.classList.add("active");
        link.setAttribute("aria-current", "page");
      }
    });

    // Scroll progress & header effect
    window.addEventListener("scroll", () => {
      const currentScroll = window.scrollY;
      header.classList.toggle("scrolled", currentScroll > 20);
      const windowHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      progressBar.style.width = (currentScroll / windowHeight) * 100 + "%";
    });

    // Collapse nav on link click (mobile)
    [...navLinks, ...dropdownItems].forEach((link) => {
      link.addEventListener("click", () => {
        if (window.innerWidth < 992 && navCollapse.classList.contains("show")) {
          const bsCollapse = bootstrap.Collapse.getInstance(navCollapse)
            || new bootstrap.Collapse(navCollapse);
          bsCollapse.hide();
        }
      });
    });

    // Dropdown Escape key support
    document.querySelectorAll(".dropdown").forEach((dropdown) => {
      dropdown.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          const toggle = dropdown.querySelector("[data-bs-toggle='dropdown']");
          bootstrap.Dropdown.getInstance(toggle)?.hide();
          toggle.focus();
        }
      });
    });
  });
</script>